# #024 ã€ŒJSONãƒ‡ãƒ¼ã‚¿å½¢å¼ã€

å››å›½ã‚ãŸã‚“ã€ŒREST APIã§ã¯JSONãŒæ¨™æº–ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã§ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒNestJSã§JSONã‚’æ‰±ã†ã¨ãã®ãƒã‚¤ãƒ³ãƒˆã¯ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€ŒDTOã§åž‹ã‚’å®šç¾©ã—class-transformerã§ã‚·ãƒªã‚¢ãƒ«åŒ–ã‚’åˆ¶å¾¡ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œnullableã‚„optionalã®æ‰±ã„ã‚‚æ˜Žç¤ºã§ãã‚‹ã­ã€
å››å›½ã‚ãŸã‚“ã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ã§ä¸è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’éš ã›ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒExposeã‚„ExcludeãŒæ´»èºã™ã‚‹ã‚„ã¤ã ã­ã€
å››å›½ã‚ãŸã‚“ã€ŒJSON Schemaã‚„OpenAPIã§å¥‘ç´„ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ã€
ãšã‚“ã ã‚‚ã‚“ã€Œåž‹ã¨å®šç¾©ã‚’é€£æºã•ã›ã‚Œã°å¤‰åŒ–ã«å¼·ããªã‚‹ã‚ˆï¼ã€

---

## ðŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// dto/user.dto.ts
import { Exclude, Expose, Transform } from 'class-transformer';
import { ApiProperty } from '@nestjs/swagger';

export class UserDto {
  @ApiProperty()
  @Expose()
  id!: string;

  @ApiProperty()
  @Expose()
  email!: string;

  @Exclude()
  passwordHash!: string;

  @ApiProperty({ required: false, nullable: true })
  @Expose()
  @Transform(({ value }) => value ?? null)
  nickname?: string | null;
}

// users.controller.ts
import { Controller, Get } from '@nestjs/common';
import { plainToInstance } from 'class-transformer';
import { UserDto } from './dto/user.dto';

@Controller('users')
export class UsersController {
  @Get()
  findAll() {
    const rows = [{ id: '1', email: 'user@example.com', passwordHash: '***' }];
    return plainToInstance(UserDto, rows, { excludeExtraneousValues: true });
  }
}

// swagger-config.ts
import { DocumentBuilder } from '@nestjs/swagger';

export const swaggerConfig = new DocumentBuilder()
  .setTitle('Example API')
  .setDescription('Example schema for JSON contracts')
  .setVersion('1.0')
  .build();
```
