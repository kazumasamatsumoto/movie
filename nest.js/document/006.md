# #006 ã€Œv11æ–°æ©Ÿèƒ½ - JSON Loggingè©³è§£ã€

å››å›½ã‚ãŸã‚“ã€Œv11ã§ã¯JSON LoggingãŒå…¬å¼ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸã€
ãšã‚“ã ã‚‚ã‚“ã€Œæ§‹é€ åŒ–ãƒ­ã‚°ã‚’æ¨™æº–ã§å‡ºã›ã‚‹ã®ã¯å¬‰ã—ã„ã­ã€
å››å›½ã‚ãŸã‚“ã€ŒConsoleLoggerã«jsonã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã€Loggerã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ä½¿ãˆã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå¤–éƒ¨ã®ãƒ­ã‚°åŸºç›¤ã«ã‚‚ã™ãé€£æºã§ãã‚‹ã‚ˆã€
å››å›½ã‚ãŸã‚“ã€Œãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã¦å‡ºåŠ›ã™ã‚Œã°ãƒˆãƒ¬ãƒ¼ã‚¹æ€§ãŒé«˜ã¾ã‚Šã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚‚UTCã§æƒãˆã‚‰ã‚Œã¦ä¾¿åˆ©ã ã­ã€
å››å›½ã‚ãŸã‚“ã€Œã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«JsonLoggerã¸åˆ‡ã‚Šæ›¿ãˆã‚‹ã ã‘ã§ç§»è¡Œã§ãã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œæœ¬ç•ªç’°å¢ƒã®å¯è¦³æ¸¬æ€§ãŒã©ã‚“ã©ã‚“æ•´ã†ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// json-logger.ts
import { ConsoleLogger, LogLevel } from '@nestjs/common';

export class JsonLogger extends ConsoleLogger {
  constructor(context?: string, levels?: LogLevel[]) {
    super(context, { logLevels: levels, json: true });
  }
}

// main.ts
import { NestFactory } from '@nestjs/core';
import { JsonLogger } from './json-logger';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule, { bufferLogs: true });
  app.useLogger(new JsonLogger('Bootstrap'));
  await app.listen(3000);
}
bootstrap();

// logging.interceptor.ts
import { CallHandler, ExecutionContext, Injectable, NestInterceptor } from '@nestjs/common';
import { JsonLogger } from './json-logger';
import { tap } from 'rxjs/operators';

@Injectable()
export class LoggingInterceptor implements NestInterceptor {
  private readonly logger = new JsonLogger(LoggingInterceptor.name);

  intercept(context: ExecutionContext, next: CallHandler) {
    const request = context.switchToHttp().getRequest<Request>();
    return next.handle().pipe(
      tap(() => this.logger.log({ path: request.url, method: request.method } as unknown as string)),
    );
  }
}
```
