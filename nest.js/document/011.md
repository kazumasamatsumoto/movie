# #011 ã€ŒNest.jsã®è¨­è¨ˆæ€æƒ³ - SOLIDåŸå‰‡ã€

å››å›½ã‚ãŸã‚“ã€ŒNestJSã¯SOLIDåŸå‰‡ã‚’å®Ÿè·µã™ã‚‹è¨­è¨ˆæ€æƒ³ã§ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå„åŸå‰‡ãŒã©ã†ã‚³ãƒ¼ãƒ‰ã«ç¾ã‚Œã‚‹ã®ã‹çŸ¥ã‚ŠãŸã„ã‚ˆã€
å››å›½ã‚ãŸã‚“ã€ŒSã¨Oã¯Controllerã¨Serviceã‚’åˆ†ã‘ã¦è²¬å‹™ã¨æ‹¡å¼µæ€§ã‚’å®ˆã‚Šã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå˜ä¸€è²¬ä»»ã§ãƒ†ã‚¹ãƒˆã‚‚èª­ã¿ã‚„ã™ããªã‚‹ã‚“ã ã­ã€
å››å›½ã‚ãŸã‚“ã€ŒLSPã¨DIPã¯æŠ½è±¡Providerã¨ä¾å­˜æ€§æ³¨å…¥ã§ä¿è¨¼ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çµŒç”±ãªã‚‰å®Ÿè£…ã‚’å·®ã—æ›¿ãˆã‚„ã™ã„ã‚ˆã€
å››å›½ã‚ãŸã‚“ã€ŒISPã¯DTOã‚„Contractsã‚’ç´°ã‹ãåˆ†ã‘ã¦ä¾å­˜ã‚’æœ€å°åŒ–ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒSOLIDã‚’æº€ãŸã™æ§‹é€ ãŒæœ€åˆã‹ã‚‰æ•´ã£ã¦ã„ã‚‹ã®ãŒå¬‰ã—ã„ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// user.repository.ts
export interface User {
  id: string;
  name: string;
}

export interface UserRepository {
  findById(id: string): Promise<User | null>;
  save(user: User): Promise<void>;
}

// prisma-user.repository.ts
import { Injectable } from '@nestjs/common';
import { PrismaService } from '../prisma.service';

@Injectable()
export class PrismaUserRepository implements UserRepository {
  constructor(private readonly prisma: PrismaService) {}

  async findById(id: string) {
    return this.prisma.user.findUnique({ where: { id } });
  }

  async save(user: User) {
    await this.prisma.user.upsert({ where: { id: user.id }, update: user, create: user });
  }
}

// user.service.ts
import { Inject, Injectable } from '@nestjs/common';
import { UserRepository } from './user.repository';

@Injectable()
export class UserService {
  constructor(
    @Inject('UserRepository') private readonly repo: UserRepository,
  ) {}

  async getProfile(id: string) {
    const user = await this.repo.findById(id);
    return user ?? { id, name: 'Guest' };
  }
}

// user.module.ts
import { Module } from '@nestjs/common';
import { UserService } from './user.service';
import { PrismaUserRepository } from './prisma-user.repository';

@Module({
  providers: [
    UserService,
    {
      provide: 'UserRepository',
      useClass: PrismaUserRepository,
    },
  ],
  exports: [UserService],
})
export class UserModule {}
```
