# #027 「開発者ツール活用 - curl」

四国めたん「curlはCLIからNestJS APIを素早く叩けるツールです」
ずんだもん「普段どんなオプションを使えばいいの？」
四国めたん「-Xでメソッド、-Hでヘッダー、-dでJSONボディを送ります」
ずんだもん「--fail-with-bodyでエラーも拾えるね」
四国めたん「-wでタイミング計測、--http2でプロトコルも試せます」
ずんだもん「スクリプトに組み込んで監視にも使えるよ」
四国めたん「環境変数化すれば接続先の切り替えも容易です」
ずんだもん「curlのワンライナーをテンプレ化しておくよ！」

---

## 📺 画面表示用コード

```typescript
// curl.config.ts
export const baseUrl = process.env.API_BASE_URL ?? 'http://localhost:3000';

// curl-runner.ts
import { execSync } from 'node:child_process';
import { baseUrl } from './curl.config';

export function curlGet(path: string) {
  const command = `curl --fail-with-body -s -w "\n%{http_code} %{time_total}s" ${baseUrl}${path}`;
  return execSync(command, { stdio: 'pipe' }).toString();
}

// curl-post.ts
import { execSync } from 'node:child_process';
import { baseUrl } from './curl.config';

export function curlPost(path: string, body: unknown) {
  const payload = JSON.stringify(body);
  const escaped = payload.replace(/'/g, "\\'");
  const command = `curl --fail-with-body -s -X POST -H \"Content-Type: application/json\" -d '${escaped}' ${baseUrl}${path}`;
  return execSync(command, { stdio: 'pipe' }).toString();
}

// curl-templates.ts
import { baseUrl } from './curl.config';

export const curlTemplates = {
  listUsers: () => `curl ${baseUrl}/users`,
  createUser: () =>
    `curl -X POST -H 'Content-Type: application/json' -d '{"email":"user@example.com"}' ${baseUrl}/users`,
};
```
