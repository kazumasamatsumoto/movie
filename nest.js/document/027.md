# #027 ã€Œé–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«æ´»ç”¨ - curlã€

å››å›½ã‚ãŸã‚“ã€Œcurlã¯CLIã‹ã‚‰NestJS APIã‚’ç´ æ—©ãå©ã‘ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œæ™®æ®µã©ã‚“ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ãˆã°ã„ã„ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œ-Xã§ãƒ¡ã‚½ãƒƒãƒ‰ã€-Hã§ãƒ˜ãƒƒãƒ€ãƒ¼ã€-dã§JSONãƒœãƒ‡ã‚£ã‚’é€ã‚Šã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œ--fail-with-bodyã§ã‚¨ãƒ©ãƒ¼ã‚‚æ‹¾ãˆã‚‹ã­ã€
å››å›½ã‚ãŸã‚“ã€Œ-wã§ã‚¿ã‚¤ãƒŸãƒ³ã‚°è¨ˆæ¸¬ã€--http2ã§ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚‚è©¦ã›ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã«çµ„ã¿è¾¼ã‚“ã§ç›£è¦–ã«ã‚‚ä½¿ãˆã‚‹ã‚ˆã€
å››å›½ã‚ãŸã‚“ã€Œç’°å¢ƒå¤‰æ•°åŒ–ã™ã‚Œã°æŽ¥ç¶šå…ˆã®åˆ‡ã‚Šæ›¿ãˆã‚‚å®¹æ˜“ã§ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œcurlã®ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬åŒ–ã—ã¦ãŠãã‚ˆï¼ã€

---

## ðŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// curl.config.ts
export const baseUrl = process.env.API_BASE_URL ?? 'http://localhost:3000';

// curl-runner.ts
import { execSync } from 'node:child_process';
import { baseUrl } from './curl.config';

export function curlGet(path: string) {
  const command = `curl --fail-with-body -s -w "\n%{http_code} %{time_total}s" ${baseUrl}${path}`;
  return execSync(command, { stdio: 'pipe' }).toString();
}

// curl-post.ts
import { execSync } from 'node:child_process';
import { baseUrl } from './curl.config';

export function curlPost(path: string, body: unknown) {
  const payload = JSON.stringify(body);
  const escaped = payload.replace(/'/g, "\\'");
  const command = `curl --fail-with-body -s -X POST -H \"Content-Type: application/json\" -d '${escaped}' ${baseUrl}${path}`;
  return execSync(command, { stdio: 'pipe' }).toString();
}

// curl-templates.ts
import { baseUrl } from './curl.config';

export const curlTemplates = {
  listUsers: () => `curl ${baseUrl}/users`,
  createUser: () =>
    `curl -X POST -H 'Content-Type: application/json' -d '{"email":"user@example.com"}' ${baseUrl}/users`,
};
```
