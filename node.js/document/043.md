# #043 「CPUキャッシュの仕組み」

```javascript
// cache-locality.mjs
const size = 1024 * 1024;
const buffer = new Float64Array(size);
console.time('sequential');
for (let i = 0; i < buffer.length; i += 1) buffer[i] *= 2;
console.timeEnd('sequential');

console.time('strided');
for (let i = 0; i < buffer.length; i += 64) buffer[i] *= 2;
console.timeEnd('strided');
```

```text
逐次アクセスはキャッシュヒット率が高く、ストライドアクセスはキャッシュミスが増えます。
```

```bash
perf stat -e cache-misses,cache-references node cache-locality.mjs
```
