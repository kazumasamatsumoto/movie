# #035 「共有メモリ」

```javascript
// sab-counter.mjs
import { Worker, isMainThread, workerData } from 'node:worker_threads';
if (isMainThread) {
  const buffer = new SharedArrayBuffer(4);
  const view = new Int32Array(buffer);
  new Worker(new URL(import.meta.url), { workerData: buffer });
  setInterval(() => console.log(Atomics.load(view, 0)), 100);
} else {
  const view = new Int32Array(workerData);
  setInterval(() => Atomics.add(view, 0, 1), 10);
}
```

```javascript
// mutex.js
import { Mutex } from 'async-mutex';
const mutex = new Mutex();
```

```bash
node sab-counter.mjs
```
