# #038 「協調的マルチタスク」

```javascript
// cooperative.mjs
import { setImmediate as immediate } from 'node:timers/promises';

async function chunkedWork() {
  for (let i = 0; i < 5; i += 1) {
    doHeavyWork();
    await immediate();
  }
}

function doHeavyWork() {
  const start = Date.now();
  while (Date.now() - start < 40) {}
}

chunkedWork();
```

```javascript
// blocking.mjs
function blockingWork() {
  const start = Date.now();
  while (Date.now() - start < 200) {}
}
setInterval(() => console.log('tick'), 50);
blockingWork();
```
