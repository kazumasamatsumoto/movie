# #017 「Pollフェーズの重要性」

```javascript
// poll-block.mjs
import http from 'node:http';
const server = http.createServer((_, res) => {
  const start = Date.now();
  while (Date.now() - start < 50) {}
  res.end('ok');
});
server.listen(0, () => console.log(`listening ${server.address().port}`));
```

```javascript
// poll-nonblock.mjs
import { setTimeout as sleep } from 'node:timers/promises';
const expensiveTask = async () => {
  for (let i = 0; i < 5; i += 1) {
    await sleep(0);
  }
};
await expensiveTask();
console.log('completed without blocking poll');
```

```bash
ab -n 100 -c 20 http://127.0.0.1:PORT/
```
