# #004 「型推論を信じたら`undefined`が飛んできた日」制作ドキュメント

## 台本
ずんだもん「型推論を信じたら`undefined`が飛んできた日って絶対あるよね？」
四国めたん「わかります。推論に任せてたら実は`string | undefined`だった、みたいな事故が多発しますよね」
ずんだもん「しかも“Non-null assertionは禁止”ってLintが叫び出して、更に詰むんだよ！」
四国めたん「それならTypeScriptのジェネリクス制約と型推論ヒントを添えて、最初から必須プロパティを保証しましょう」
ずんだもん「いや待って、それ書いたらジェネリクス3段重ねになってレビューで引かれるやつ！」
四国めたん「共感した方は“推論あるある”ってコメントで教えてください！」
ずんだもん「あなたのTypeScriptあるあるも募集中だよ！」

## 画面表示用コード

```typescript
type User = { id: string; name?: string };

function hasName(user: User): user is User & { name: string } {
  return typeof user.name === "string";
}

function firstWithName<T extends User>(items: readonly T[]) {
  const target = items.find(hasName);
  if (!target) throw new Error("name missing");
  return target;
}

const users = [{ id: "u1", name: "m" }];
const firstUser = firstWithName(users);

type Name = typeof firstUser.name;

function shout(name: Name) {
  return name.toUpperCase();
}

shout(firstUser.name);
```

## 制作メモ
- **想定シーン**: 推論を信じて書いたら実行時に`undefined`が混入して炎上する瞬間
- **狙いトーン**: 焦り→対策→さらなる複雑化をテンポ良く描く
- **技術キーワード**: 型推論, 型ガード, ジェネリクス制約, `infer`
- **使いたい一言**: 「推論あるある」
- **CTA案**: コメントで「推論を信じたらこうなった」体験談を募集
- **備考**: 非null保証の型ガードを画面に出して、“安全にするための一手間”をアピールする
