# #542 ã€ŒDTOãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€

å››å›½ã‚ãŸã‚“ã€ŒDTOãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨neverå‹ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ï¼ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒDTOãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã©ã†ä½¿ã†ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’åˆ¤åˆ¥Unionå‹ã§è¡¨ç¾ã—ã€ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’ç¶²ç¾…çš„ã«å‡¦ç†ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå…·ä½“çš„ã«ã©ã†å®Ÿè£…ã™ã‚‹ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œclass-validatorã¨çµ„ã¿åˆã‚ã›ã¦ã€å‹å®‰å…¨ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¤ãƒ—ã‚’å®Ÿè£…ã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãªã‚‹ã»ã©ï¼å…¥åŠ›å€¤ã®æ¤œè¨¼ãŒå‹å®‰å…¨ã«ãªã‚‹ã‚“ã ã­ï¼ã€
å››å›½ã‚ãŸã‚“ã€ŒNest.jsã®DTOãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç›¸æ€§ãŒè‰¯ãã€å®Ÿç”¨çš„ã§ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒAPIã®å“è³ªãŒå¤§å¹…ã«å‘ä¸Šã™ã‚‹ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœå‹
type ValidationResult<T> =
  | { valid: true; data: T }
  | { valid: false; errors: ValidationError[] };

function validate<T>(dto: T): ValidationResult<T> {
  const errors = validateSync(dto);
  if (errors.length === 0) return { valid: true, data: dto };
  return { valid: false, errors };
}

function handleValidation<T>(result: ValidationResult<T>): T {
  if (result.valid) return result.data;
  if (!result.valid) throw new BadRequestException(result.errors);
  const check: never = result;
}
```

```typescript
// å‹å®‰å…¨ãªDTOå¤‰æ›
type CreateUserDto = { name: string; email: string };
type UpdateUserDto = { name?: string; email?: string };
type DtoType = 'create' | 'update';

function transformDto(type: DtoType, data: any): CreateUserDto | UpdateUserDto {
  if (type === 'create') return plainToClass(CreateUserDto, data);
  if (type === 'update') return plainToClass(UpdateUserDto, data);
  const check: never = type;
  throw new Error('Invalid DTO type');
}
```

```typescript
// ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚¿
type ValidationRule =
  | { type: 'required'; field: string }
  | { type: 'email'; field: string }
  | { type: 'minLength'; field: string; min: number };

function applyRule(rule: ValidationRule, value: any): boolean {
  if (rule.type === 'required') return value != null;
  if (rule.type === 'email') return /\S+@\S+\.\S+/.test(value);
  if (rule.type === 'minLength') return value.length >= rule.min;
  const check: never = rule;
  return false;
}
```
