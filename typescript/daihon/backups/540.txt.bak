# #540 ã€ŒAPIè¨­è¨ˆã€

å››å›½ã‚ãŸã‚“ã€ŒAPIè¨­è¨ˆã«ãŠã‘ã‚‹neverå‹ã®æ´»ç”¨ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ï¼ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒAPIè¨­è¨ˆã§neverå‹ã‚’ã©ã†ä½¿ã†ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ã€ã‚¨ãƒ©ãƒ¼å‹ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤åˆ¥Unionå‹ã§å®šç¾©ã—ã€å‹å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå…·ä½“çš„ã«ã©ã†è¨­è¨ˆã™ã‚‹ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‹ã§è¡¨ç¾ã—ã€ç¶²ç¾…çš„ã«å‡¦ç†ã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãªã‚‹ã»ã©ï¼APIã®ä»•æ§˜ãŒå‹ã§æ˜ç¢ºã«ãªã‚‹ã‚“ã ã­ï¼ã€
å››å›½ã‚ãŸã‚“ã€Œãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§å‹ã‚’å…±æœ‰ã§ãã€é–‹ç™ºåŠ¹ç‡ãŒå‘ä¸Šã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå‹å®‰å…¨ãªAPIé–‹ç™ºãŒå®Ÿç¾ã§ãã‚‹ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// API ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹
type ApiResponse<T> =
  | { status: 'success'; data: T }
  | { status: 'error'; error: { code: string; message: string } }
  | { status: 'loading' };

function handleResponse<T>(res: ApiResponse<T>): T | null {
  if (res.status === 'success') return res.data;
  if (res.status === 'error') throw new Error(res.error.message);
  if (res.status === 'loading') return null;
  const check: never = res;
  return null;
}
```

```typescript
// REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå‹
type Endpoint =
  | { method: 'GET'; path: string }
  | { method: 'POST'; path: string; body: unknown }
  | { method: 'DELETE'; path: string };

async function request(endpoint: Endpoint): Promise<Response> {
  if (endpoint.method === 'GET') return fetch(endpoint.path);
  if (endpoint.method === 'POST') return fetch(endpoint.path, { method: 'POST', body: JSON.stringify(endpoint.body) });
  if (endpoint.method === 'DELETE') return fetch(endpoint.path, { method: 'DELETE' });
  const check: never = endpoint;
  throw new Error('Invalid endpoint');
}
```

```typescript
// GraphQLæ“ä½œå‹
type GqlOperation =
  | { type: 'query'; query: string }
  | { type: 'mutation'; mutation: string }
  | { type: 'subscription'; subscription: string };

function executeGql(op: GqlOperation): Promise<any> {
  if (op.type === 'query') return client.query({ query: op.query });
  if (op.type === 'mutation') return client.mutate({ mutation: op.mutation });
  if (op.type === 'subscription') return client.subscribe({ query: op.subscription });
  const check: never = op;
}
```
