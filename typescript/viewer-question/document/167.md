# #167 「パラメータデコレータ、使いどころある？」制作ドキュメント

## 台本
ずんだもん「パラメータデコレータ、使いどころある？」
四国めたん「v5.9ではパラメータデコレータはメソッドの引数にメタデータを付与でき、DIやバリデーションで使われます」
ずんだもん「ぼくはNest.jsで`@Param`や`@Body`みたいなカスタムデコレータを作る時に使ったことがあるんだよね」
四国めたん「パラメータデコレータ自体は値を変更できませんが、メタデータを記録して他のデコレータと組み合わせます」
ずんだもん「APIのパラメータバリデーションをパラメータデコレータで実装したら、宣言的で読みやすくなったんだよ！」
四国めたん「みなさんはパラメータデコレータを使っていますか？」
ずんだもん「使いどころや実装例をコメントで教えてね！」

## 画面表示用コード

```typescript
// パラメータデコレータの基本
function LogParameter(target: any, propertyKey: string, parameterIndex: number) {
  console.log(`Parameter at index ${parameterIndex} in ${propertyKey}`);
}

class UserService {
  getUser(@LogParameter id: string) {
    // ...
  }
}
```

```typescript
// バリデーションデコレータ（メタデータを記録）
const requiredParams = new Map<string, number[]>();

function Required(target: any, propertyKey: string, parameterIndex: number) {
  const params = requiredParams.get(propertyKey) || [];
  params.push(parameterIndex);
  requiredParams.set(propertyKey, params);
}

function Validate(
  target: any,
  propertyKey: string,
  descriptor: PropertyDescriptor
) {
  const originalMethod = descriptor.value;
  descriptor.value = function(...args: any[]) {
    const required = requiredParams.get(propertyKey) || [];
    for (const index of required) {
      if (args[index] == null) {
        throw new Error(`Parameter at index ${index} is required`);
      }
    }
    return originalMethod.apply(this, args);
  };
}

class API {
  @Validate
  createUser(@Required name: string, @Required email: string, age?: number) {
    // ...
  }
}
```

## 制作メモ
- **問いの切り口**: パラメータデコレータの使いどころ
- **想定視聴者層**: デコレータを活用したいエンジニア
- **押さえる技術キーワード**: パラメータデコレータ, メタデータ, バリデーション
- **キャラの立場**: 四国めたん=メタデータ記録の説明 / ずんだもん=宣言的な記述の利点
- **コメントで聞きたいこと**: 使いどころや実装例
- **補足メモ**: メソッドデコレータと組み合わせる実用例を提示
