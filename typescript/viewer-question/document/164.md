# #164 「デコレータの型、理解してる？」制作ドキュメント

## 台本
ずんだもん「デコレータの型、理解してる？」
四国めたん「v5.9ではデコレータがStage 3として正式化され、型定義も標準化されています」
ずんだもん「ぼくはデコレータの型シグネチャを理解するまで時間がかかったけど、理解したら自作デコレータが書けるようになったんだよね」
四国めたん「デコレータの型は、対象（クラス、メソッド、プロパティなど）によって異なるシグネチャを持ちます」
ずんだもん「Nest.jsのカスタムデコレータを作る時、型定義をちゃんと書いたら型安全に使えて便利だったんだよ！」
四国めたん「みなさんはデコレータの型を理解していますか？」
ずんだもん「学習経験や実装例をコメントで教えてね！」

## 画面表示用コード

```typescript
// クラスデコレータの型
type ClassDecorator = <T extends new (...args: any[]) => any>(
  target: T
) => T | void;

function Entity(target: any) {
  // クラスにメタデータを付与
  target.prototype.isEntity = true;
}

@Entity
class User {
  name: string;
}
```

```typescript
// メソッドデコレータの型
type MethodDecorator = <T>(
  target: Object,
  propertyKey: string | symbol,
  descriptor: TypedPropertyDescriptor<T>
) => TypedPropertyDescriptor<T> | void;

function Log(
  target: any,
  propertyKey: string,
  descriptor: PropertyDescriptor
) {
  const originalMethod = descriptor.value;
  descriptor.value = function(...args: any[]) {
    console.log(`Calling ${propertyKey}`);
    return originalMethod.apply(this, args);
  };
}

class Service {
  @Log
  execute() {
    console.log('Executing...');
  }
}
```

```typescript
// プロパティデコレータの型
type PropertyDecorator = (
  target: Object,
  propertyKey: string | symbol
) => void;

function Required(target: any, propertyKey: string) {
  // プロパティのメタデータを設定
}

class User {
  @Required
  email: string;
}
```

## 制作メモ
- **問いの切り口**: デコレータの型の理解度
- **想定視聴者層**: デコレータを使いたいエンジニア
- **押さえる技術キーワード**: デコレータ, 型シグネチャ, メタデータ
- **キャラの立場**: 四国めたん=正式化と型の説明 / ずんだもん=学習過程と実用例
- **コメントで聞きたいこと**: 理解度や学習経験、実装例
- **補足メモ**: 各種デコレータの型シグネチャを明示
