# #145 「`union`の分配を止める技、使ってる？」制作ドキュメント

## 台本
ずんだもん「`union`の分配を止める技、使ってる？」
四国めたん「v5.9ではタプル型でラップする技法により、条件型の分配を制御できます」
ずんだもん「ぼくは`[T] extends [U]`パターンで分配を止めて、ユニオン全体を一つの型として扱うことがあるんだよね」
四国めたん「タプルでラップすると、TypeScriptは分配を行わず、型全体を一度に評価します」
ずんだもん「配列型を作る時に、分配されると困るケースで`[T]`技法が役立ったんだよ！」
四国めたん「みなさんはユニオンの分配を止める技を使っていますか？」
ずんだもん「使用ケースやテクニックをコメントで教えてね！」

## 画面表示用コード

```typescript
// 通常の条件型（分配される）
type Wrap<T> = T extends any ? { value: T } : never;

type Result1 = Wrap<'a' | 'b'>;
// { value: 'a' } | { value: 'b' } （分配される）
```

```typescript
// タプルでラップ（分配を止める）
type WrapAll<T> = [T] extends [any] ? { value: T } : never;

type Result2 = WrapAll<'a' | 'b'>;
// { value: 'a' | 'b' } （分配されない）
```

```typescript
// 実用例: ユニオン全体を配列に
type ToArray<T> = T extends any ? T[] : never;
type NonDistToArray<T> = [T] extends [any] ? T[] : never;

type Dist = ToArray<string | number>;    // string[] | number[]
type NonDist = NonDistToArray<string | number>; // (string | number)[]
```

```typescript
// ユニオンをチェックする型
type IsUnion<T> = [T] extends [infer U]
  ? U extends T
    ? [T] extends [U]
      ? false
      : true
    : never
  : never;
```

## 制作メモ
- **問いの切り口**: ユニオン分配を止める技法の使用
- **想定視聴者層**: 高度な型操作を行うエンジニア
- **押さえる技術キーワード**: 分配制御, タプルラップ, [T] extends [U], 条件型
- **キャラの立場**: 四国めたん=技法の仕組み解説 / ずんだもん=実用的な場面紹介
- **コメントで聞きたいこと**: 使用ケースやテクニック
- **補足メモ**: 分配される場合とされない場合の明確な対比と実用例
