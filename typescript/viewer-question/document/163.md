# #163 「ミックスインパターン、実装したことある？」制作ドキュメント

## 台本
ずんだもん「ミックスインパターン、実装したことある？」
四国めたん「v5.9ではミックスインパターンにより、多重継承のような機能をTypeScriptで実現できます」
ずんだもん「ぼくは複数の機能を組み合わせたいけど多重継承できない時に、ミックスインを使うことがあるんだよね」
四国めたん「ミックスインは関数でクラスを拡張し、複数の振る舞いを動的に組み合わせる高度なパターンです」
ずんだもん「タイムスタンプ機能とログ機能をミックスインで実装したら、必要なクラスだけに柔軟に追加できたんだよ！」
四国めたん「みなさんはミックスインパターンを実装したことがありますか？」
ずんだもん「実装例や使いどころをコメントで教えてね！」

## 画面表示用コード

```typescript
// ミックスインの型定義
type Constructor<T = {}> = new (...args: any[]) => T;

// タイムスタンプミックスイン
function Timestamped<TBase extends Constructor>(Base: TBase) {
  return class extends Base {
    createdAt = new Date();
    updatedAt = new Date();

    touch() {
      this.updatedAt = new Date();
    }
  };
}

// ログミックスイン
function Loggable<TBase extends Constructor>(Base: TBase) {
  return class extends Base {
    log(message: string) {
      console.log(`[${this.constructor.name}] ${message}`);
    }
  };
}

// 基本クラス
class User {
  constructor(public name: string) {}
}

// ミックスインを適用
const TimestampedUser = Timestamped(User);
const LoggableUser = Loggable(User);
const EnhancedUser = Loggable(Timestamped(User));

// 使用例
const user = new EnhancedUser('Alice');
user.log('User created'); // Loggableの機能
user.touch();             // Timestampedの機能
console.log(user.createdAt); // Timestampedの機能
```

```typescript
// 型安全なミックスイン
interface Timestamped {
  createdAt: Date;
  updatedAt: Date;
  touch(): void;
}

function createTimestamped<T extends Constructor>(Base: T): T & Constructor<Timestamped> {
  return class extends Base implements Timestamped {
    createdAt = new Date();
    updatedAt = new Date();
    touch() { this.updatedAt = new Date(); }
  };
}
```

## 制作メモ
- **問いの切り口**: ミックスインパターンの実装経験
- **想定視聴者層**: 高度な設計パターンに興味があるエンジニア
- **押さえる技術キーワード**: ミックスイン, 多重継承, クラス拡張, 合成
- **キャラの立場**: 四国めたん=パターンの仕組み解説 / ずんだもん=柔軟な組み合わせの利点
- **コメントで聞きたいこと**: 実装経験や使いどころ
- **補足メモ**: 複数のミックスインを組み合わせる実用例を提示
