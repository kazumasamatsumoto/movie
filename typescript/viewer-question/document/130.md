# #130 「`readonly`配列、デフォルトにしてる？」制作ドキュメント

## 台本
ずんだもん「`readonly`配列、デフォルトにしてる？」
四国めたん「v5.9では`readonly`配列の型推論が改善され、不変性を保つコードが書きやすくなっています」
ずんだもん「ぼくは関数の引数は基本`ReadonlyArray`にして、変更が必要な場合だけ通常の配列を使うんだよね」
四国めたん「`readonly`配列をデフォルトにすると、関数が配列を変更しないことが型で保証され、予期しない副作用を防げます」
ずんだもん「ユーティリティ関数の引数を全部`readonly`にしたら、バグの原因になってた隠れた配列変更が見つかったんだよ！」
四国めたん「みなさんは`readonly`配列をデフォルトにしていますか？」
ずんだもん「運用ルールや効果をコメントで教えてね！」

## 画面表示用コード

```typescript
// 関数の引数をreadonly配列に
function sum(numbers: ReadonlyArray<number>): number {
  // numbers.push(10); // Error: プロパティ 'push' は存在しません
  return numbers.reduce((acc, n) => acc + n, 0);
}

function filterEven(numbers: ReadonlyArray<number>): number[] {
  return numbers.filter(n => n % 2 === 0); // 新しい配列を返す
}
```

```typescript
// readonly配列の型エイリアス
type Items<T> = ReadonlyArray<T>;

function processItems<T>(items: Items<T>): Items<T> {
  return items.map(item => transform(item));
}
```

```typescript
// 変更が必要な場合は明示的に通常の配列を使う
function addItem<T>(items: ReadonlyArray<T>, newItem: T): T[] {
  return [...items, newItem];
}

function mutateArray(items: T[]): void {
  items.push(newItem); // 意図的な変更
}
```

## 制作メモ
- **問いの切り口**: readonly配列のデフォルト使用
- **想定視聴者層**: 関数の副作用を明確にしたいエンジニア
- **押さえる技術キーワード**: ReadonlyArray, readonly, 不変性, 副作用
- **キャラの立場**: 四国めたん=型による保証の解説 / ずんだもん=実践的な効果報告
- **コメントで聞きたいこと**: readonly配列のデフォルト使用状況やルール
- **補足メモ**: 副作用の明示化によるバグ防止効果を強調
