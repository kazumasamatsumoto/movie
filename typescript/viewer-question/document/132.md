# #132 「配列の`push`を型エラーにする設定してる？」制作ドキュメント

## 台本
ずんだもん「配列の`push`を型エラーにする設定してる？」
四国めたん「v5.9では`readonly`配列を使うことで、`push`や`pop`などの破壊的メソッドが型エラーになります」
ずんだもん「ぼくはESLintの`functional/immutable-data`ルールで、通常配列への破壊的操作も警告するようにしてるんだよね」
四国めたん「`readonly`配列を使うと、`push`などのメソッドが型レベルで禁止され、不変更新を強制できます」
ずんだもん「配列の直接変更を禁止したら、Reactのstate管理でバグが劇的に減ったんだよ！」
四国めたん「みなさんは配列の破壊的操作を制限していますか？」
ずんだもん「設定方法や効果をコメントで教えてね！」

## 画面表示用コード

```typescript
// readonly配列でpushを型エラーに
const numbers: readonly number[] = [1, 2, 3];
// numbers.push(4); // Error: プロパティ 'push' は型 'readonly number[]' に存在しません

// 不変更新を使う
const newNumbers = [...numbers, 4]; // OK
```

```typescript
// ESLintで破壊的メソッドを警告
// eslint-plugin-functional
{
  "rules": {
    "functional/immutable-data": "error",
    "functional/no-let": "warn",
    "functional/prefer-readonly-type": "warn"
  }
}
```

```typescript
// Reactでの実用例
function TodoList() {
  const [todos, setTodos] = useState<readonly Todo[]>([]);

  const addTodo = (todo: Todo) => {
    // setTodos(prev => { prev.push(todo); return prev; }); // Error
    setTodos(prev => [...prev, todo]); // OK: 新しい配列を作成
  };
}
```

## 制作メモ
- **問いの切り口**: 配列のpushを型エラーにする設定
- **想定視聴者層**: 不変性を強制したいエンジニア
- **押さえる技術キーワード**: readonly, 破壊的メソッド, 不変更新, ESLint
- **キャラの立場**: 四国めたん=型レベルの制限解説 / ずんだもん=実用的効果報告
- **コメントで聞きたいこと**: 破壊的操作の制限方法や効果
- **補足メモ**: TypeScriptとESLintの両方によるアプローチを提示
