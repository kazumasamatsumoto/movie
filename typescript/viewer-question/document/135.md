# #135 「`Object.freeze`の型、どう扱ってる？」制作ドキュメント

## 台本
ずんだもん「`Object.freeze`の型、どう扱ってる？」
四国めたん「v5.9では`Object.freeze`の型推論が改善され、readonlyプロパティとして扱われるようになっています」
ずんだもん「ぼくは`Object.freeze`と`as const`を組み合わせて、実行時とコンパイル時の両方で不変性を保証してるんだよね」
四国めたん「`Object.freeze`は実行時に不変性を保証しますが、TypeScriptの型システムだけでは浅いreadonlyにしかなりません」
ずんだもん「設定オブジェクトを`Object.freeze`したら、本番で誤って書き換えるバグを防げたんだよ！」
四国めたん「みなさんは`Object.freeze`の型をどう扱っていますか？」
ずんだもん「型定義の工夫や使い方をコメントで教えてね！」

## 画面表示用コード

```typescript
// Object.freezeの基本的な使用
const config = Object.freeze({
  apiUrl: 'https://api.example.com',
  timeout: 5000,
});

// config.apiUrl = 'new'; // 実行時エラー（strict mode）
// 型レベルでもreadonlyになる
```

```typescript
// as constと組み合わせて深い不変性を型で表現
const config = Object.freeze({
  api: {
    url: 'https://api.example.com',
    timeout: 5000,
  },
} as const);

// config.api.url = 'new'; // 型エラー（as constにより）
```

```typescript
// Deep Freeze用のヘルパー型
type DeepReadonly<T> = {
  readonly [P in keyof T]: T[P] extends object
    ? DeepReadonly<T[P]>
    : T[P];
};

function deepFreeze<T extends object>(obj: T): DeepReadonly<T> {
  Object.freeze(obj);
  Object.values(obj).forEach(value => {
    if (typeof value === 'object' && value !== null) {
      deepFreeze(value);
    }
  });
  return obj as DeepReadonly<T>;
}
```

## 制作メモ
- **問いの切り口**: Object.freezeの型の扱い方
- **想定視聴者層**: 実行時の不変性も保証したいエンジニア
- **押さえる技術キーワード**: Object.freeze, readonly, as const, 実行時不変性
- **キャラの立場**: 四国めたん=型システムとの関係解説 / ずんだもん=実用的な組み合わせ
- **コメントで聞きたいこと**: Object.freezeの型定義の工夫や使い方
- **補足メモ**: コンパイル時と実行時の両方での不変性保証を提示
