# #157 「`protected`の使いどころ、どう判断してる？」制作ドキュメント

## 台本
ずんだもん「`protected`の使いどころ、どう判断してる？」
四国めたん「v5.9では`protected`は継承先でのみアクセス可能で、クラス階層の設計で重要な役割を果たします」
ずんだもん「ぼくは継承先で拡張させたいメソッドやプロパティに`protected`を使って、完全に隠したい場合は`private`にしてるんだよね」
四国めたん「`protected`は適切に使えば拡張性を保ちつつカプセル化できますが、過度に使うと設計が複雑になります」
ずんだもん「基底クラスで`protected`を使い過ぎて、継承先での依存が強くなりすぎた失敗があるんだよ！」
四国めたん「みなさんは`protected`をどう使い分けていますか？」
ずんだもん「判断基準や経験をコメントで教えてね！」

## 画面表示用コード

```typescript
// protectedの適切な使用
abstract class BaseRepository<T> {
  // 継承先で使えるユーティリティメソッド
  protected async executeQuery(sql: string): Promise<any[]> {
    // データベース接続処理
    return [];
  }

  // 完全に隠す
  private connectionPool: any;

  // 継承先で実装させる
  abstract findById(id: string): Promise<T | null>;
}

class UserRepository extends BaseRepository<User> {
  async findById(id: string): Promise<User | null> {
    // protectedメソッドを使える
    const rows = await this.executeQuery(`SELECT * FROM users WHERE id = ?`);
    return rows[0] ? this.mapToUser(rows[0]) : null;
  }

  private mapToUser(row: any): User {
    return { id: row.id, name: row.name };
  }
}
```

```typescript
// protectedの過度な使用（アンチパターン）
class BadBase {
  protected data: any;
  protected config: any;
  protected utils: any;
  protected helpers: any;
  // すべてprotected → 継承先が基底クラスに強く依存
}

// 良い設計: 必要最小限のprotected
class GoodBase {
  private data: any;
  private config: any;

  // 継承先で本当に必要なものだけ
  protected getData(): any {
    return this.data;
  }
}
```

## 制作メモ
- **問いの切り口**: protectedの使いどころの判断
- **想定視聴者層**: クラス継承を設計するエンジニア
- **押さえる技術キーワード**: protected, 継承, カプセル化, 拡張性
- **キャラの立場**: 四国めたん=適切な使い方解説 / ずんだもん=過度な使用の失敗経験
- **コメントで聞きたいこと**: 使い分けの判断基準や経験
- **補足メモ**: 適切な使用と過度な使用の対比を明示
