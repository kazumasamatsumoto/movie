# #119 「`catch`節の`error`型、どう扱ってる？」制作ドキュメント

## 台本
ずんだもん「`catch`節の`error`型、どう扱ってる？」
四国めたん「v5.9では`useUnknownInCatchVariables`により、catch節のerrorが`unknown`型になり、より安全な処理が求められます」
ずんだもん「ぼくは必ず型ガードでErrorかどうかチェックしてから、メッセージやスタックトレースにアクセスするんだよね」
四国めたん「catch節では何がスローされるか予測できないため、`unknown`として扱い、型の絞り込みを行うのがベストプラクティスです」
ずんだもん「サードパーティライブラリが文字列やオブジェクトをthrowすることがあって、型ガードで助かったんだよ！」
四国めたん「みなさんはcatch節のerrorをどう扱っていますか？」
ずんだもん「エラーハンドリングのベストプラクティスをコメントで教えてね！」

## 画面表示用コード

```typescript
// 基本的な型ガードパターン
try {
  await fetchData();
} catch (error) {
  if (error instanceof Error) {
    console.error('Error:', error.message);
    console.error('Stack:', error.stack);
  } else if (typeof error === 'string') {
    console.error('String error:', error);
  } else {
    console.error('Unknown error:', error);
  }
}
```

```typescript
// ユーティリティ関数でエラーを正規化
function toError(error: unknown): Error {
  if (error instanceof Error) return error;
  if (typeof error === 'string') return new Error(error);
  return new Error('Unknown error occurred');
}

try {
  await riskyOperation();
} catch (error) {
  const normalizedError = toError(error);
  logger.error(normalizedError.message);
}
```

```typescript
// カスタムエラー型のガード
class ApiError extends Error {
  constructor(public statusCode: number, message: string) {
    super(message);
  }
}

try {
  await apiCall();
} catch (error) {
  if (error instanceof ApiError) {
    console.error(`API Error ${error.statusCode}:`, error.message);
  } else if (error instanceof Error) {
    console.error('Generic error:', error.message);
  }
}
```

## 制作メモ
- **問いの切り口**: catch節のerror型の扱い方
- **想定視聴者層**: エラーハンドリングの型安全性を高めたいエンジニア
- **押さえる技術キーワード**: catch, unknown, 型ガード, エラーハンドリング
- **キャラの立場**: 四国めたん=ベストプラクティス解説 / ずんだもん=実務経験からの知見
- **コメントで聞きたいこと**: error型の扱い方やベストプラクティス
- **補足メモ**: 実用的なエラー正規化パターンを複数提示
