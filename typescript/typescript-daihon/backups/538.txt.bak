# #538 ã€ŒNest.jsä¾‹å¤–ãƒ•ã‚£ãƒ«ã‚¿ã€

å››å›½ã‚ãŸã‚“ã€ŒNest.jsã®ä¾‹å¤–ãƒ•ã‚£ãƒ«ã‚¿ã¨neverå‹ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ï¼ã€
ãšã‚“ã ã‚‚ã‚“ã€Œä¾‹å¤–ãƒ•ã‚£ãƒ«ã‚¿ã§neverå‹ã‚’ã©ã†ä½¿ã†ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œã™ã¹ã¦ã®ä¾‹å¤–ã‚¿ã‚¤ãƒ—ã‚’ç¶²ç¾…çš„ã«å‡¦ç†ã—ã€æœªå‡¦ç†ã®ä¾‹å¤–ã‚’neverå‹ã§æ¤œå‡ºã§ãã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå…·ä½“çš„ã«ã©ã†å®Ÿè£…ã™ã‚‹ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œåˆ¤åˆ¥Unionå‹ã§ä¾‹å¤–ã‚’å®šç¾©ã—ã€catchãƒ¡ã‚½ãƒƒãƒ‰ã§ç¶²ç¾…çš„ã«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãªã‚‹ã»ã©ï¼ä¾‹å¤–å‡¦ç†ã®æ¼ã‚Œã‚’é˜²ã’ã‚‹ã‚“ã ã­ï¼ã€
å››å›½ã‚ãŸã‚“ã€Œå‹å®‰å…¨ãªä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«ã‚ˆã‚Šã€ã‚¨ãƒ©ãƒ¼å¯¾å¿œã®å“è³ªãŒå‘ä¸Šã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã§ã®ä¿¡é ¼æ€§ãŒä¸ŠãŒã‚‹ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// ä¾‹å¤–ã‚¿ã‚¤ãƒ—ã®å®šç¾©
type AppException =
  | { type: 'validation'; errors: string[] }
  | { type: 'unauthorized'; message: string }
  | { type: 'notfound'; resource: string };

@Catch()
export class AllExceptionsFilter implements ExceptionFilter {
  catch(exception: AppException, host: ArgumentsHost) {
    if (exception.type === 'validation') return this.handleValidation(exception);
    if (exception.type === 'unauthorized') return this.handleUnauth(exception);
    if (exception.type === 'notfound') return this.handleNotFound(exception);
    const check: never = exception;
  }
}
```

```typescript
// HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ç¶²ç¾…çš„å‡¦ç†
type HttpError = 400 | 401 | 403 | 404 | 500;

function getErrorMessage(status: HttpError): string {
  if (status === 400) return 'Bad Request';
  if (status === 401) return 'Unauthorized';
  if (status === 403) return 'Forbidden';
  if (status === 404) return 'Not Found';
  if (status === 500) return 'Internal Server Error';
  const check: never = status;
  return 'Unknown Error';
}
```

```typescript
// ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ãƒ•ã‚£ãƒ«ã‚¿
type DomainException =
  | { domain: 'user'; code: 'NOT_FOUND' | 'DUPLICATE' }
  | { domain: 'order'; code: 'INVALID' | 'EXPIRED' };

function handleException(ex: DomainException): HttpException {
  if (ex.domain === 'user') return new BadRequestException(ex.code);
  if (ex.domain === 'order') return new UnprocessableEntityException(ex.code);
  const check: never = ex;
  throw new InternalServerErrorException();
}
```
