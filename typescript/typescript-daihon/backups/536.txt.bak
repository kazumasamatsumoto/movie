# #536 ã€ŒAngularã‚¬ãƒ¼ãƒ‰ã€

å››å›½ã‚ãŸã‚“ã€ŒAngularã‚¬ãƒ¼ãƒ‰ã¨neverå‹ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ï¼ã€
ãšã‚“ã ã‚‚ã‚“ã€ŒAngularã‚¬ãƒ¼ãƒ‰ã§neverå‹ã‚’ã©ã†ä½¿ã†ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œãƒ«ãƒ¼ãƒˆã‚¬ãƒ¼ãƒ‰ã®æˆ»ã‚Šå€¤å‹ã§ã€åˆ°é”ä¸å¯èƒ½ãªã‚±ãƒ¼ã‚¹ã‚’neverå‹ã§è¡¨ç¾ã§ãã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå…·ä½“çš„ã«ã©ã†æ›¸ãã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€ŒCanActivateã®æˆ»ã‚Šå€¤ã‚’Observable<boolean | UrlTree | never>ã¨å®šç¾©ã—ã€ã‚¨ãƒ©ãƒ¼æ™‚ã®å‹å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãªã‚‹ã»ã©ï¼å‹å®‰å…¨ãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ãŒã§ãã‚‹ã‚“ã ã­ï¼ã€
å››å›½ã‚ãŸã‚“ã€Œç¶²ç¾…æ€§ãƒã‚§ãƒƒã‚¯ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã™ã¹ã¦ã®ã‚±ãƒ¼ã‚¹ã‚’å‡¦ç†ã§ãã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®å“è³ªãŒå‘ä¸Šã™ã‚‹ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// Angular Guard with neverå‹
type GuardResult = boolean | UrlTree | never;

@Injectable()
export class AuthGuard implements CanActivate {
  canActivate(route: ActivatedRouteSnapshot): Observable<GuardResult> {
    return this.authService.isAuthenticated$.pipe(
      map(isAuth => isAuth ? true : this.router.parseUrl('/login'))
    );
  }
}
```

```typescript
// ç¶²ç¾…çš„ãªã‚¬ãƒ¼ãƒ‰å®Ÿè£…
type AuthState = 'authenticated' | 'guest' | 'expired';

canActivate(state: AuthState): boolean | UrlTree {
  if (state === 'authenticated') return true;
  if (state === 'guest') return this.router.parseUrl('/login');
  if (state === 'expired') return this.router.parseUrl('/renew');
  const check: never = state;
  return false;
}
```

```typescript
// å‹å®‰å…¨ãªãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
type RedirectResult =
  | { allow: true }
  | { allow: false; redirect: string };

function checkAccess(role: string): RedirectResult {
  if (role === 'admin') return { allow: true };
  return { allow: false, redirect: '/forbidden' };
}
```
