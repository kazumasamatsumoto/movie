# #543 ã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ã€

å››å›½ã‚ãŸã‚“ã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ã®è¨­è¨ˆã¨neverå‹ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ï¼ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ã£ã¦ã©ã†è¨­è¨ˆã™ã‚‹ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€ŒæˆåŠŸã€ã‚¨ãƒ©ãƒ¼ã€èª­ã¿è¾¼ã¿ä¸­ãªã©ã®çŠ¶æ…‹ã‚’åˆ¤åˆ¥Unionå‹ã§è¡¨ç¾ã—ã€å‹å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå…·ä½“çš„ã«ã©ã†ä½¿ã†ã®ï¼Ÿã€
å››å›½ã‚ãŸã‚“ã€Œãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§åŒã˜å‹å®šç¾©ã‚’å…±æœ‰ã—ã€ç¶²ç¾…çš„ã«å‡¦ç†ã—ã¾ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œãªã‚‹ã»ã©ï¼APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ‰±ã„ãŒçµ±ä¸€ã•ã‚Œã‚‹ã‚“ã ã­ï¼ã€
å››å›½ã‚ãŸã‚“ã€ŒAngular HttpClientã‚„RxJSã¨ã®ç›¸æ€§ã‚‚æŠœç¾¤ã§ã™ã­ã€
ãšã‚“ã ã‚‚ã‚“ã€Œå‹å®‰å…¨ãªAPIé€šä¿¡ãŒå®Ÿç¾ã§ãã‚‹ã‚ˆï¼ã€

---

## ğŸ“º ç”»é¢è¡¨ç¤ºç”¨ã‚³ãƒ¼ãƒ‰

```typescript
// æ¨™æº–ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹
type ApiResponse<T> =
  | { status: 'success'; data: T; timestamp: number }
  | { status: 'error'; error: { code: string; message: string } }
  | { status: 'loading' };

function handleResponse<T>(res: ApiResponse<T>): T | null {
  if (res.status === 'success') return res.data;
  if (res.status === 'error') {
    console.error(res.error);
    return null;
  }
  if (res.status === 'loading') return null;
  const check: never = res;
  return null;
}
```

```typescript
// ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒ¬ã‚¹ãƒãƒ³ã‚¹
type PagedResponse<T> =
  | { hasData: true; items: T[]; total: number; page: number }
  | { hasData: false; reason: 'empty' | 'error' };

function processPage<T>(res: PagedResponse<T>): T[] {
  if (res.hasData) return res.items;
  if (!res.hasData && res.reason === 'empty') return [];
  if (!res.hasData && res.reason === 'error') throw new Error('Failed');
  const check: never = res;
  return [];
}
```

```typescript
// HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä»˜ããƒ¬ã‚¹ãƒãƒ³ã‚¹
type HttpResponse<T> =
  | { status: 200; data: T }
  | { status: 201; data: T; location: string }
  | { status: 204 }
  | { status: 400 | 404 | 500; error: string };

function handle<T>(res: HttpResponse<T>): T | null {
  if (res.status === 200) return res.data;
  if (res.status === 201) return res.data;
  if (res.status === 204) return null;
  if (res.status >= 400) throw new Error(res.error);
  const check: never = res;
}
```
